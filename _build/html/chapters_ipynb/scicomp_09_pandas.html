

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5. Manipulating tabular data with Pandas &#8212; Introduction to Computation for the Physics Sciences</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters_ipynb/scicomp_09_pandas';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Data reduction and analysis magic with pandas" href="scicomp_10_pandas_magic.html" />
    <link rel="prev" title="4. Monte Carlo" href="scicomp_08_montecarlo.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/wj_horiz_color.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/wj_horiz_color.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">I. Python basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scicomp_00_basics.html">1. Basic syntax, variables, functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_01_controlstructs.html">2. Control structures, numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_02_typescontainers.html">3. Types, random numbers, lists, dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_03_fileio.html">4. File I/O</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">II. Techniques for the physical sciences</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scicomp_04_datavis.html">1. Data visualization with <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_05_fitting.html">2. Fitting models to data</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_07_ODEs.html">3. Simulating solutions to differential equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_08_montecarlo.html">4. Monte Carlo</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Manipulating tabular data with <code class="docutils literal notranslate"><span class="pre">Pandas</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_10_pandas_magic.html">6. Data reduction and analysis magic with <code class="docutils literal notranslate"><span class="pre">pandas</span></code></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">III. Optional (but fun)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scicomp_06_textasdata.html">1. Text as data</a></li>
<li class="toctree-l1"><a class="reference internal" href="scicomp_11_circuitpython.html">2. Python on microcontrollers with <code class="docutils literal notranslate"><span class="pre">circuitpython</span></code></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters_ipynb/scicomp_09_pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters_ipynb/scicomp_09_pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Manipulating tabular data with Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap">5.1. Recap</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">5.2. Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pandas">5.3. What is pandas?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ahem-what-is-pandas">5.4. Ahem… What is <code class="docutils literal notranslate"><span class="pre">pandas</span></code>?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-series">5.5. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">Series</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframe">5.6. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warm-up-problem">Warm-up problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Warm-up problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copying-a-dataframe">Copying a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-data-as-a-dataframe">5.7. Importing data as a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Warm-up problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exporting-to-csv">5.8. Exporting to csv</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-summary">5.9. In summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">5.10. Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regulars">Regulars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meanies">Meanies</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="manipulating-tabular-data-with-pandas">
<h1><span class="section-number">5. </span>Manipulating tabular data with <code class="docutils literal notranslate"><span class="pre">Pandas</span></code><a class="headerlink" href="#manipulating-tabular-data-with-pandas" title="Permalink to this heading">#</a></h1>
<section id="recap">
<h2><span class="section-number">5.1. </span>Recap<a class="headerlink" href="#recap" title="Permalink to this heading">#</a></h2>
<p>Let’s continue with our skills inventory with the foundations/applications dichotomy:</p>
<ul class="simple">
<li><p>foundational programming skills</p>
<ul>
<li><p>basic mathematical operations, comparison operators</p></li>
<li><p>iteration and recursion with loop control structures <code class="docutils literal notranslate"><span class="pre">for</span></code> and <code class="docutils literal notranslate"><span class="pre">while</span></code></p></li>
<li><p>keeping track of variables outside of loops (i.e., counting and summing)</p></li>
<li><p>function definition and using functions <em>inside</em> of loops</p></li>
<li><p>conditionals: <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">else</span></code>, and <code class="docutils literal notranslate"><span class="pre">elif</span></code></p></li>
<li><p>types: <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code></p></li>
<li><p>containers such as <code class="docutils literal notranslate"><span class="pre">list</span></code> and <code class="docutils literal notranslate"><span class="pre">dict</span></code></p></li>
<li><p>randm number generation</p></li>
<li><p>accessing and iterating over elements in lists and dicts</p></li>
<li><p>file I/O</p></li>
<li><p>DEBUGGING!</p></li>
<li><p>algorithmic thinking</p></li>
</ul>
</li>
<li><p>applications</p>
<ul>
<li><p>basic (and semi-advanced) data visualization: histograms, scatter plots, higher-dimensions in 2-d</p></li>
<li><p>fitting models to data and extracting results (with uncertainties)</p></li>
<li><p>text analysis, asking questions with unstructured data</p></li>
<li><p>simulating the solutions to ordinary differential equations, Euler Algorithm</p></li>
<li><p>basic Monte Carlo techniques</p></li>
</ul>
</li>
</ul>
<p>I am running out of congratulatory things to say about the length and diversity of this list, so I’ll just summarize with: <strong>Wowzerz</strong>.</p>
</section>
<hr class="docutils" />
<section id="motivation">
<h2><span class="section-number">5.2. </span>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">#</a></h2>
<p>Only one motivational item for you today!  After today’s class, you will have all of the basic skills necessary to start learning about Machine Learning (if you wish to do so).  A Kaggle Competition is a great place to start!</p>
<ul class="simple">
<li><p>Kaggle. <a class="reference external" href="https://www.kaggle.com/competitions/titanic">Titanic – Machine Learning from Disaster</a>.  Skip forward to 2:00 in the explanatory video linked.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="what-is-pandas">
<h2><span class="section-number">5.3. </span>What is pandas?<a class="headerlink" href="#what-is-pandas" title="Permalink to this heading">#</a></h2>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Giant_panda">Wikipedia</a></p>
<blockquote>
<div><p>The giant panda (Ailuropoda melanoleuca; Chinese: 大熊猫; pinyin: dàxióngmāo) also known as the panda bear (or simply the panda), is a bear species endemic to China. It is characterised by its bold black-and-white coat and rotund body. The name “giant panda” is sometimes used to distinguish it from the red panda, a neighboring musteloid.</p>
</div></blockquote>
<p>These pandas do not manage tabular data; rather, they eat bamboo.</p>
<p>OK, thanks!  Homework is due in one week.</p>
</section>
<section id="ahem-what-is-pandas">
<h2><span class="section-number">5.4. </span>Ahem… What is <code class="docutils literal notranslate"><span class="pre">pandas</span></code>?<a class="headerlink" href="#ahem-what-is-pandas" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> is a very popular <code class="docutils literal notranslate"><span class="pre">python</span></code> library that is built to manage tabular data.  By “tabular data” we mean something like a spreadsheet – information that is arranged into separate instances (typically rows) and features (typically columns).</p>
<p>Now, we have already worked with tabular data in this class.  We read data from a file (usually CSV formatted) using some basic file I/O procedures (<code class="docutils literal notranslate"><span class="pre">readline()</span></code>, <code class="docutils literal notranslate"><span class="pre">string.split()</span></code>, etc.).  When we introduced this, you may have thought to yourself “There has <strong>got</strong> to be a better, more-efficient way of doing this!”  If you thought this, you were correct!  <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is the better, more-efficient way of working with tabular data in <code class="docutils literal notranslate"><span class="pre">python</span></code>.</p>
<p>In this tutorial, we’re going to cover the basics of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> fucntionality, but it’s important to state that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> is <em>soooooo powerful</em> that it is a professional-grade tool, ubiquitous in the quantitative world!  Researchers in the physical sciences, social sciences, finance, medicine, and public health use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> to work with large, complex, real-world data.  As a result, there is a great wealth of <code class="docutils literal notranslate"><span class="pre">pandas</span></code> information and help online!</p>
<p>There are (at least) two ways to introduce <code class="docutils literal notranslate"><span class="pre">pandas</span></code>: from the basic <code class="docutils literal notranslate"><span class="pre">pandas</span></code> structures up to the tabular dataset level, or from the tabular dataset level down to the basic structures.  We’ll take the first approach, but you might consider going through this notebook backwards to see how the concepts connect in the opposite way.</p>
</section>
<hr class="docutils" />
<section id="pandas-series">
<h2><span class="section-number">5.5. </span><code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">Series</span></code><a class="headerlink" href="#pandas-series" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> organizes data based on two structures: <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> are composed of <code class="docutils literal notranslate"><span class="pre">Series</span></code>(es).</p>
<p>The structure of <code class="docutils literal notranslate"><span class="pre">Series</span></code> <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">(documentation here, take a look at all of those attributes/methods!)</a> will seem familiar to you – it’s basically an ordered list with a lot of other slick features built into it!  Let’s take iport the module and initialize a <code class="docutils literal notranslate"><span class="pre">Series</span></code> to see what it can do.</p>
<p>We’ll start with some data stored as a basic <code class="docutils literal notranslate"><span class="pre">python</span></code> list and then convert convert it to a <code class="docutils literal notranslate"><span class="pre">Series</span></code>.  Ooh, let’s do some role-playing, too: We are the managers of a restaurant, and we want to build a dataset that contains information about our menu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">rich</span> <span class="kn">import</span> <span class="nb">print</span> <span class="c1">## comment out if you don&#39;t have rich installed</span>

<span class="n">menu</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aloo chana&#39;</span><span class="p">,</span> <span class="s1">&#39;cheeseburger&#39;</span><span class="p">,</span> <span class="s1">&#39;jjajangmeon&#39;</span><span class="p">,</span> <span class="s1">&#39;cacio e pepe&#39;</span><span class="p">,</span> <span class="s1">&#39;bubble tea&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;paleta&#39;</span><span class="p">,</span> <span class="s1">&#39;enchiladas&#39;</span><span class="p">,</span> <span class="s1">&#39;cauliflower shawarma&#39;</span><span class="p">,</span> <span class="s1">&#39;tikil gomen&#39;</span><span class="p">]</span>

<span class="n">menu_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>              aloo chana
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>            cheeseburger
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>             jjajangmeon
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>            cacio e pepe
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>              bubble tea
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>                        
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>                  paleta
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>              enchiladas
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>    cauliflower shawarma
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>             tikil gomen
dtype: object
</pre>
</div></div>
</div>
<p>At this point, <code class="docutils literal notranslate"><span class="pre">Series</span></code> looks pretty boring.  It’s basically a list with more-sophisticated <code class="docutils literal notranslate"><span class="pre">print</span></code> formatting. Notice that when the <code class="docutils literal notranslate"><span class="pre">Series</span></code> is printed, it happens in two dimensions – the first column is the <em>index column</em> and the second column is the <em>value column</em>.</p>
<p>Ok, so what can we do with this?  Well, <code class="docutils literal notranslate"><span class="pre">Series</span></code> has many nice features that align with the types of things that scientists like to do with data!  Let’s blast through a few (of the many, many) of these below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_ser</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;dish&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>              aloo chana
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>            cheeseburger
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>             jjajangmeon
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>            cacio e pepe
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>              bubble tea
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>                        
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">6</span>                  paleta
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">7</span>              enchiladas
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>    cauliflower shawarma
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">9</span>             tikil gomen
Name: dish, dtype: object
</pre>
</div></div>
</div>
<p>Appending to a <code class="docutils literal notranslate"><span class="pre">Series</span></code> is complicated!  We need to first create a <code class="docutils literal notranslate"><span class="pre">Series</span></code> of the stuff that we want to append, and then <code class="docutils literal notranslate"><span class="pre">append</span></code> the new series to the original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_dishes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;quesadilla&#39;</span><span class="p">,</span> <span class="s1">&#39;jollof rice&#39;</span><span class="p">,</span> <span class="s1">&#39;grilled chili peppers&#39;</span><span class="p">,</span> <span class="s1">&#39;ma la fish&#39;</span><span class="p">,</span> <span class="s1">&#39;schnitzel&#39;</span><span class="p">,</span> <span class="s1">&#39;empanadas&#39;</span><span class="p">]</span>
<span class="n">new_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">new_dishes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dish&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_ser</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ser</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #008080; text-decoration-color: #008080; font-weight: bold">0</span>               quesadilla
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">1</span>              jollof rice
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">2</span>    grilled chili peppers
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">3</span>               ma la fish
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">4</span>                schnitzel
<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">5</span>                empanadas
Name: dish, dtype: object
</pre>
</div><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="nn">/var/folders/6s/cpr1t_711kj905fk6qjplyrw0000gr/T/ipykernel_61172/2769499521.py</span> in <span class="ni">?</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">new_dishes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;quesadilla&#39;</span><span class="p">,</span> <span class="s1">&#39;jollof rice&#39;</span><span class="p">,</span> <span class="s1">&#39;grilled chili peppers&#39;</span><span class="p">,</span> <span class="s1">&#39;ma la fish&#39;</span><span class="p">,</span> <span class="s1">&#39;schnitzel&#39;</span><span class="p">,</span> <span class="s1">&#39;empanadas&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">new_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">new_dishes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dish&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="n">new_ser</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> 
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ser</span><span class="p">))</span>

<span class="nn">~/opt/miniconda3/envs/snakes/lib/python3.11/site-packages/pandas/core/generic.py</span> in <span class="ni">?</span><span class="nt">(self, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">5985</span>             <span class="ow">and</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_accessors</span>
<span class="g g-Whitespace">   </span><span class="mi">5986</span>             <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info_axis</span><span class="o">.</span><span class="n">_can_hold_identifiers_and_holds_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">5987</span>         <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">5988</span>             <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">5989</span>         <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="ne">AttributeError</span>: &#39;Series&#39; object has no attribute &#39;append&#39;
</pre></div>
</div>
</div>
</div>
<p><em><strong>It is VERY important to realize</strong></em> that the <code class="docutils literal notranslate"><span class="pre">append</span></code> call above does <strong>NOT</strong> change the original series by default.  That is, when we append the new <code class="docutils literal notranslate"><span class="pre">Series</span></code> to the old, the result that is created is <strong>not stored</strong> in either of the original variables!  This might seem annoying (and it <em>is</em> annoying), but <code class="docutils literal notranslate"><span class="pre">pandas</span></code> works this way so that it is very difficult to <em>accidentally</em> change your data in some catastrophic way.</p>
<p>If we want to append and then replace the original <code class="docutils literal notranslate"><span class="pre">Series</span></code>, we have to replace the old one “by hand”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;dish&#39;</span><span class="p">)</span>
<span class="n">menu_ser</span> <span class="o">=</span> <span class="n">menu_ser</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ser</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You may notice that the indices are goofed up!  The <code class="docutils literal notranslate"><span class="pre">Series</span></code> that I appended had its own index system when I created it, and we now have <em>duplicate indices</em>.  We can solve this by including the <code class="docutils literal notranslate"><span class="pre">ignore_index=True</span></code> argument when we call <code class="docutils literal notranslate"><span class="pre">append</span></code>.  (Try it above!)</p>
<p>Access of individual elements of the <code class="docutils literal notranslate"><span class="pre">Series</span></code> is a little bit more complicated (but more flexible) than it is with a basic <code class="docutils literal notranslate"><span class="pre">list</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_ser</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can also access elements of the <code class="docutils literal notranslate"><span class="pre">Series</span></code> by value!  The syntax below looks really odd at first, but it is in some ways similar the way that we access elements of a <code class="docutils literal notranslate"><span class="pre">dictionary</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">[</span><span class="n">menu_ser</span> <span class="o">==</span> <span class="s1">&#39;quesadilla&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">[</span><span class="n">menu_ser</span> <span class="o">==</span> <span class="s1">&#39;quesadilla&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Some other handy features:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - - -&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">sort_values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - - -&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># let&#39;s see if we can get rid of that empty entry</span>
<span class="n">menu_ser</span> <span class="o">=</span> <span class="n">menu_ser</span><span class="p">[</span><span class="n">menu_ser</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="n">menu_ser</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;dish&#39;</span>
<span class="n">menu_ser</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - - -&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">menu_ser</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>While we’re at it let’s create a couple more <code class="docutils literal notranslate"><span class="pre">Series</span></code> that contain other information about these items from our imaginary restaurant:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prices</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">,</span> <span class="mf">12.00</span><span class="p">,</span> <span class="mf">12.00</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">2.50</span><span class="p">,</span> <span class="mf">11.00</span><span class="p">,</span> <span class="mf">9.00</span><span class="p">,</span> <span class="mf">10.00</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">9.00</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">,</span> <span class="mf">16.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
<span class="n">prices_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">prices</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;price&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prices_ser</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - - -&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">masses</span> <span class="o">=</span> <span class="p">[</span><span class="mi">450</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">475</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">]</span>
<span class="n">masses_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">masses</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mass&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">masses_ser</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - - -&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="n">spicy</span> <span class="o">=</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">spicy_ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">spicy</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;spiciness&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spicy_ser</span><span class="p">)</span>
<span class="n">spicy_ser</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">10.5</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - - -&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Note the built-in plot functionality of <code class="docutils literal notranslate"><span class="pre">Series</span></code>!</p>
<p>OK!  We now have three <strong>separate</strong> series that contain information about the <strong>same set of entities</strong>.</p>
<p><strong>Let’s pause</strong>.  This is basically where were were in our previous tabular data manipulations.  We would read lines of information from a file, split the line into individual features, and then append these individual features to separate lists for later computation, visualization, <em>etc.</em>  Using <code class="docutils literal notranslate"><span class="pre">Series</span></code> to store this information makes it very clear how inefficient/stupid this approach is.  Notice that the indices in our three separate series all point to the same instances – that is, index 1 refers to features of the cheeseburger in <code class="docutils literal notranslate"><span class="pre">names_ser</span></code>, <code class="docutils literal notranslate"><span class="pre">prices_ser</span></code>, and <code class="docutils literal notranslate"><span class="pre">masses_ser</span></code>.  Having three copies of the same set of indices is a big waste of data!</p>
<p>In addition, if we want to perform some manipulation of one of the series, say sorting the items by price, sorting the <code class="docutils literal notranslate"><span class="pre">Series</span></code> that stores price information will not automatically sort the other two series.  Everything I’ve just said is true of storing this information in three separate lists.</p>
<p>Both of these shortcoming arise from the fact that we are (and were) storing tabular, multidimensional data in several different, unconnected containers.  Hmmmmm, if only there were some way to combine all of these series into a single coherent thingy…</p>
</section>
<hr class="docutils" />
<section id="pandas-dataframe">
<h2><span class="section-number">5.6. </span><code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#pandas-dataframe" title="Permalink to this heading">#</a></h2>
<p>In the examples above, we were using <code class="docutils literal notranslate"><span class="pre">Series</span></code> to store and manipulate what are essentially columns in a tabular dataset.  Picture a spreadsheet in which each row is an item on a restaurant menu, and each column represents features like the item’s name, price, mass, and spiciness.  Manipulating these columns separately from one another is possible, but opens the door wide for mistakes, errors, goof-ups, oopsies, oversights, negligencies, blunders, fumbles, …</p>
<p>A <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is a structure that stores this tabular all at once, manipulating rows and columns in concert.  The <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object has many built-in operations that are useful for data science, AND has lots of built-in protections to prevent us from doing things that we might not wish to do.</p>
<p>We can create a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> from the individual series that we created in the previous section:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">menu_ser</span><span class="p">,</span> <span class="n">prices_ser</span><span class="p">,</span> <span class="n">masses_ser</span><span class="p">,</span> <span class="n">spicy_ser</span><span class="p">]</span>
<span class="n">menu_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">menu_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">menu_df</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Wow!  Now that probably looks familiar!  Our tabular data is organized as a table, in which it’s clear which feature values are associated with which items.  Each of our feature columns is nicely labeled with the <code class="docutils literal notranslate"><span class="pre">name</span></code> property of the <code class="docutils literal notranslate"><span class="pre">Series</span></code> that we used to create it!</p>
<p>There are lots of great ways to manipulate a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>!  (Notice that Jupyter knows how to nicely typeset a dataframe, too!)  We can sort:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">,</span> <span class="s1">&#39;dish&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can add new features (columns), as long as we’re careful to order the new feature values relative to the dataframe index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">menu_df</span><span class="p">)</span>
<span class="n">vegan_list</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;vegan&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vegan_list</span>
<span class="n">cuisines_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Indian&#39;</span><span class="p">,</span> <span class="s1">&#39;American&#39;</span><span class="p">,</span> <span class="s1">&#39;Korean&#39;</span><span class="p">,</span> <span class="s1">&#39;Italian&#39;</span><span class="p">,</span> <span class="s1">&#39;Taiwanese&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;Central American&#39;</span><span class="p">,</span> <span class="s1">&#39;Tex-Mex&#39;</span><span class="p">,</span> <span class="s1">&#39;Middle-Eastern&#39;</span><span class="p">,</span> <span class="s1">&#39;Ethiopian&#39;</span><span class="p">,</span> <span class="s1">&#39;Tex-Mex&#39;</span><span class="p">,</span> 
                 <span class="s1">&#39;West African&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Sichuan&#39;</span><span class="p">,</span> <span class="s1">&#39;German&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentinian&#39;</span><span class="p">]</span>
<span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;cuisine&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cuisines_list</span>
<span class="n">costs_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.00</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">4.50</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.50</span><span class="p">,</span> <span class="mf">3.00</span><span class="p">,</span> <span class="mf">7.00</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">7.00</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">13.50</span><span class="p">,</span> <span class="mf">9.00</span><span class="p">,</span> <span class="mf">3.50</span><span class="p">]</span>
<span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">costs_list</span>
<span class="n">menu_df</span>
</pre></div>
</div>
</div>
</div>
<p>We can also grab a subset of the dataframe based on values!  What if a customer asks about vegan options?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="p">[</span><span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;vegan&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Where possible, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can use the names of the features/columns as attributes of the dataframe.  What the heck does this mean?  It means that the block below does the same as the block above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="p">[</span><span class="n">menu_df</span><span class="o">.</span><span class="n">vegan</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>What if a customer asks about vegan options and is very hungry?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="p">[</span><span class="n">menu_df</span><span class="o">.</span><span class="n">vegan</span> <span class="o">==</span> <span class="kc">True</span><span class="p">][</span><span class="n">menu_df</span><span class="o">.</span><span class="n">mass</span> <span class="o">&gt;=</span> <span class="mi">400</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Yum, lots of great options!</p>
<section id="warm-up-problem">
<h3>Warm-up problem<a class="headerlink" href="#warm-up-problem" title="Permalink to this heading">#</a></h3>
<p>Add a new item to the menu using a dictionary (Google it!).  Make up values for the relevant features!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## hot dog code goes here!</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<p>The real utility of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> for our purposes is the ability to do calculations with data in the dataframe simultaneously for all rows.  Let’s say we want to add a reasonable tip (20%) to each item’s price:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;price_w_tip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.20</span>
<span class="n">menu_df</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we know the total cost of each item, we may want to determine something like the “best value” dish on the menu (assuming that all of the flavors are equally enjoyable).  We could do the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;mass_per_dollar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;price_w_tip&#39;</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Median mass per dollar of items on our menu:&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;mass_per_dollar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="s1">&#39;g/USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average mass per dollar of items on our menu:&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;mass_per_dollar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="s1">&#39;g/USD&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Std dev mass per dollar of items on our menu:&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">menu_df</span><span class="p">[</span><span class="s1">&#39;mass_per_dollar&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="s1">&#39;g/USD&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;- - - - - - - -&#39;</span><span class="p">)</span>
<span class="n">menu_df</span><span class="p">[</span><span class="n">menu_df</span><span class="o">.</span><span class="n">mass_per_dollar</span> <span class="o">==</span> <span class="n">menu_df</span><span class="o">.</span><span class="n">mass_per_dollar</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<p>So maybe we just buy \$15 worth of paletas?</p>
<p>Our dataframe now combines raw data and interesting calculated quantities.  Let’s look at some visualizations of this information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">menu_df</span><span class="o">.</span><span class="n">mass_per_dollar</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">80</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;mass per dollar (g/USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">menu_df</span><span class="o">.</span><span class="n">price_w_tip</span><span class="p">,</span> <span class="n">menu_df</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">menu_df</span><span class="o">.</span><span class="n">spiciness</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;autumn_r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;price w/ tip (USD)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mass&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">menu_df</span><span class="o">.</span><span class="n">price_w_tip</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">menu_df</span><span class="o">.</span><span class="n">mass</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">))</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;spiciness&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Warm-up problem<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>Modify the code above to make a scatter plot of price vs cost, color-coded by mass.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## warm-up code goes here</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="copying-a-dataframe">
<h3>Copying a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#copying-a-dataframe" title="Permalink to this heading">#</a></h3>
<p>One thing that we haven’t addressed up to this point is how to copy some common <code class="docutils literal notranslate"><span class="pre">python</span></code> objects.  For example, let’s say we have a list of values that we need to update – perhaps it’s the list of balances in several back accounts.  We might wish to create a copy of the list that can serve as a record of the original values that were stored in the list.  You might guess that we can just initiatlize a new variable in the following way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">balances</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">754</span><span class="p">,</span> <span class="mi">23432</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">updated_balances</span> <span class="o">=</span> <span class="n">balances</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">updated_balances</span><span class="p">)):</span>
    <span class="n">updated_balances</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">10</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">updated_balances</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Great!  But what about our original list?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">balances</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Wait, WUT?  That’s no good.</p>
<p>The problem here is that when we set the value of the object <code class="docutils literal notranslate"><span class="pre">updated_balances</span></code> equal to the object <code class="docutils literal notranslate"><span class="pre">balances</span></code>, <code class="docutils literal notranslate"><span class="pre">python</span></code> doesn’t <em>copy</em> the values in the latter to the former.  Rather, it makes the new variable a <strong>reference</strong> to the latter!  So, <code class="docutils literal notranslate"><span class="pre">updated_balances</span></code> isn’t it’s own object – it’s just another way of accessing <code class="docutils literal notranslate"><span class="pre">balances</span></code>.</p>
<p>If we want to copy the list (or many other objects), we need to use the <code class="docutils literal notranslate"><span class="pre">copy()</span></code> method that is built into <code class="docutils literal notranslate"><span class="pre">list</span></code>.  Let’s try again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">balances</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">754</span><span class="p">,</span> <span class="mi">23432</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">updated_balances</span> <span class="o">=</span> <span class="n">balances</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">updated_balances</span><span class="p">)):</span>
    <span class="n">updated_balances</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">10</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">updated_balances</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">balances</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Whew, that looks better!  This is one of those times where not being aware of one strange behavior of a language can cause HUGE and hard to debug problems for your future software.  You have been warned!</p>
<hr class="docutils" />
<p>Copying/referencing a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> works the same way.  Let’s say we want to copy the <code class="docutils literal notranslate"><span class="pre">menu_df</span></code> that we worked with earlier for use at a new vegan-only restaurant location we’re opening across town.  The new location will be <em>fancy</em>, so we’ll jack up all of the prices by \$1.00.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_location_menu_df</span> <span class="o">=</span> <span class="n">menu_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">new_location_menu_df</span> <span class="o">=</span> <span class="n">new_location_menu_df</span><span class="p">[</span><span class="n">new_location_menu_df</span><span class="o">.</span><span class="n">vegan</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
<span class="n">new_location_menu_df</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="n">new_location_menu_df</span><span class="o">.</span><span class="n">price</span> <span class="o">+</span> <span class="mf">1.00</span>
<span class="n">new_location_menu_df</span><span class="o">.</span><span class="n">price_w_tip</span> <span class="o">=</span> <span class="n">new_location_menu_df</span><span class="o">.</span><span class="n">price</span> <span class="o">*</span> <span class="mf">1.2</span>
<span class="n">new_location_menu_df</span>
</pre></div>
</div>
</div>
</div>
<p>And we can check to make sure that we haven’t goofed up our original dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">menu_df</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="importing-data-as-a-dataframe">
<h2><span class="section-number">5.7. </span>Importing data as a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code><a class="headerlink" href="#importing-data-as-a-dataframe" title="Permalink to this heading">#</a></h2>
<p>I think you’ll agree with me that this looks incredible and very fun.  There’s only one problem: If I want to work with a (possibly very large) dataset (with many instances and features), I don’t want to build up a dataframe column by column.  That would be <strong>terrible</strong>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> people have thought of this!  There is a straight-forward way to read in data stored in some tabular-ish format (csv, tsv, Excel[!]) directly into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>Let’s take a look at how this is done [you’re gonna love this] with the <code class="docutils literal notranslate"><span class="pre">movies.csv</span></code> dataset that is maintained by <a class="reference external" href="https://mine-cr.com/">Mine Çetinkaya-Rundel</a>.  This is a medium-size dataset (651 movies), so we don’t want to print the whole thing to screen.  We’ll use <code class="docutils literal notranslate"><span class="pre">head</span></code> to look at the first 20 rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data_files/movies.csv&#39;</span><span class="p">)</span>
<span class="n">movies_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">movies_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movies_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The movies in this dataset were released between&#39;</span><span class="p">,</span> <span class="n">movies_df</span><span class="o">.</span><span class="n">thtr_rel_year</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> 
      <span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">movies_df</span><span class="o">.</span><span class="n">thtr_rel_year</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>How many top-200 box office films are on this list?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies_df</span><span class="p">[</span><span class="n">movies_df</span><span class="o">.</span><span class="n">top200_box</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
</div>
<p>What are the different film ratings represented in the dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies_df</span><span class="o">.</span><span class="n">mpaa_rating</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Oooh, interesting!  What NC-17 movies are on the list? (Asking for a friend…)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">movies_df</span><span class="p">[</span><span class="n">movies_df</span><span class="o">.</span><span class="n">mpaa_rating</span> <span class="o">==</span> <span class="s1">&#39;NC-17&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
</div>
</div>
<p>Wait, what about Unrated films?  What the heck is an Unrated film?  When were these things released?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unrated_df</span> <span class="o">=</span> <span class="n">movies_df</span><span class="p">[</span><span class="n">movies_df</span><span class="o">.</span><span class="n">mpaa_rating</span> <span class="o">==</span> <span class="s1">&#39;Unrated&#39;</span><span class="p">]</span>
<span class="n">unrated_df</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">unrated_df</span><span class="o">.</span><span class="n">thtr_rel_year</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">44</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">1970</span><span class="p">,</span> <span class="mi">2014</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Hmmmmm, weird!</p>
<section id="id2">
<h3>Warm-up problem<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Make a bar graph that shows the numbers of films with each rating?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## warm-up code goes here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exporting-to-csv">
<h2><span class="section-number">5.8. </span>Exporting to csv<a class="headerlink" href="#exporting-to-csv" title="Permalink to this heading">#</a></h2>
<p>Note that we can also export a dataframe to several common filetypes.  Let’s export our <code class="docutils literal notranslate"><span class="pre">menu_df</span></code> to csv:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="n">today</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
<span class="n">menu_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;menu_dataframe_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">today</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Take a peek to see if <code class="docutils literal notranslate"><span class="pre">python</span></code> created this file in your current working directory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pandas</span></code> river is wide AND DEEEEEEEEP.  There’s a lot of useful functionality that we’re not covering here.  If you’re working on a data project and you think “Ya know, it would be great if <code class="docutils literal notranslate"><span class="pre">pandas</span></code> could do XYZ”, chances are very good that <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <em>does</em> do XYZ and documentation is just a Google away.</p>
</section>
<hr class="docutils" />
<section id="in-summary">
<h2><span class="section-number">5.9. </span>In summary<a class="headerlink" href="#in-summary" title="Permalink to this heading">#</a></h2>
<p>What happened above was a somewhat involved intro to how Pandas structures <code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> – it’s probably way more information than you will need for 95% of your work with tabular data.  Usually, we simply import a dataset as a <code class="docutils literal notranslate"><span class="pre">dataframe</span></code> and start calculating or plotting.  The problems below will give you an idea of the types of manipulations that we most often perform when doing data analysis.  Enjoy!</p>
</section>
<hr class="docutils" />
<section id="problems">
<h2><span class="section-number">5.10. </span>Problems<a class="headerlink" href="#problems" title="Permalink to this heading">#</a></h2>
<p>Your homework is to complete two (2) of the following problems.</p>
<section id="regulars">
<h3>Regulars<a class="headerlink" href="#regulars" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Obtain the <a class="reference external" href="https://www.kaggle.com/datasets/ashishjangra27/ted-talks">TED Talks dataset from Kaggle</a>.  Make histograms of watches, likes, and likes per watch.  Find the title of the most ‘under-appreciated’ Talk.  (You determine what is meant by this.  What would be a good metric for under-appreciatedness?)</p></li>
<li><p>Obtain the <a class="reference external" href="https://www.kaggle.com/datasets/anandaramg/taxi-trip-data-nyc">Taxi trip data NYC</a> dataset.  Make histograms of trip duration (in minutes), trip distance (in miles), and average trip speed (in mph).  Make a scatter plot or 2-d histogram of trip duration vs trip distance.  Note that you’ll have to do some significant parsing (processing of alphanumeric strings) of the information in the time columns to calculate the ride duration!</p></li>
</ol>
</section>
<section id="meanies">
<h3>Meanies<a class="headerlink" href="#meanies" title="Permalink to this heading">#</a></h3>
<ol class="arabic simple" start="3">
<li><p>Obtain the <a class="reference external" href="https://www.kaggle.com/datasets/hmavrodiev/london-bike-sharing-dataset">London bike sharing dataset</a>.  Make a graph that shows number of shares (aggregated over all days in the dataset) <em>vs</em> hour of the day.  What is the peak bikeshare hour?  Make a graph that shows aggregate number of bikeshares <em>vs</em> temperature.  Are Londoners cold-weather wimps?</p></li>
</ol>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "executablebooks/jupyter-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters_ipynb"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="scicomp_08_montecarlo.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Monte Carlo</p>
      </div>
    </a>
    <a class="right-next"
       href="scicomp_10_pandas_magic.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Data reduction and analysis magic with <code class="docutils literal notranslate"><span class="pre">pandas</span></code></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recap">5.1. Recap</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">5.2. Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pandas">5.3. What is pandas?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ahem-what-is-pandas">5.4. Ahem… What is <code class="docutils literal notranslate"><span class="pre">pandas</span></code>?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-series">5.5. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">Series</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframe">5.6. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#warm-up-problem">Warm-up problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Warm-up problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#copying-a-dataframe">Copying a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-data-as-a-dataframe">5.7. Importing data as a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Warm-up problem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exporting-to-csv">5.8. Exporting to csv</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-summary">5.9. In summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problems">5.10. Problems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regulars">Regulars</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meanies">Meanies</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mike McCracken
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>